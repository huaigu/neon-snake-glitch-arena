# 新的游戏得分系统

## 得分机制

### 1. 存活分数 (Survival Score)
- **频率**: 每10个游戏tick
- **分数**: +1分
- **条件**: 蛇必须存活且不处于观察者模式
- **实现**: 本地计算，无需事件同步

### 2. 食物分数 (Food Score)

#### 食物等级和分数
| 等级 | 分数 | 概率 | 视觉效果 |
|------|------|------|----------|
| 1级  | +10分 | 70% | 绿色，无动画 |
| 2级  | +20分 | 25% | 蓝色，脉冲动画，显示"2" |
| 3级  | +50分 | 5%  | 黄色，脉冲+跳跃动画，显示"3" |

#### 食物生成逻辑
```typescript
// 70% 概率生成1级食物
// 25% 概率生成2级食物  
// 5% 概率生成3级食物

const rand = random();
if (rand < 0.70) {
  level = 1; value = 10;
} else if (rand < 0.95) {
  level = 2; value = 20;
} else {
  level = 3; value = 50;
}
```

## 技术实现

### 模型层变更

#### GameRoomModel.ts
1. **新增属性**:
   ```typescript
   tickCounter!: number;  // tick计数器
   ```

2. **Food接口更新**:
   ```typescript
   interface Food {
     x: number;
     y: number;
     type: 'normal' | 'bonus';
     level: 1 | 2 | 3;  // 新增等级
     value: number;     // 根据等级计算的分数
   }
   ```

3. **gameTick()方法**:
   - 增加tick计数器
   - 每10个tick给存活蛇加1分

4. **checkFoodConsumption()方法**:
   - 根据食物等级给予对应分数
   - 1级食物: +10分
   - 2级食物: +20分
   - 3级食物: +50分

5. **spawnFood()方法**:
   - 按概率生成不同等级的食物
   - 自动设置对应的分数值

### UI层变更

#### useSnakeGame.ts
- 更新Food接口以支持level属性
- 兼容性处理: `level: food.level || 1`

#### GameArea.tsx
- 根据食物等级显示不同颜色和动画
- 1级: 绿色，无特殊效果
- 2级: 蓝色，脉冲动画，显示数字"2"
- 3级: 黄色，脉冲+跳跃动画，显示数字"3"

## 得分计算示例

### 游戏场景
假设一局游戏持续100个tick，玩家吃了以下食物：
- 3个1级食物 (30分)
- 2个2级食物 (40分)  
- 1个3级食物 (50分)

### 最终得分
```
存活分数: 100 tick ÷ 10 = 10分
食物分数: 30 + 40 + 50 = 120分
总分: 10 + 120 = 130分
```

## 平衡性设计

### 得分来源占比
- **存活分数**: 提供稳定的基础分数，鼓励保守玩法
- **食物分数**: 提供主要分数来源，鼓励积极进食

### 风险回报机制
- 1级食物: 低风险低回报，维持基本成长
- 2级食物: 中等风险中等回报
- 3级食物: 高风险高回报，需要冒险争夺

### 时间因素
每10个tick = 1分的设计确保：
- 长期存活有意义
- 但食物分数仍是主要来源
- 游戏节奏保持紧张有趣

## 排行榜影响

新的得分系统将提高排行榜分数的区分度：
- 技术好的玩家能获得更多高级食物
- 存活时间长的玩家有基础分数保底
- 总分范围扩大，排名更有意义

## 未来扩展

可考虑增加的机制：
1. **连击系统**: 连续吃同等级食物获得加分
2. **特殊食物**: 临时效果食物 (速度、无敌等)
3. **分数衰减**: 长时间不吃食物扣分
4. **团队分数**: 多人合作模式的分数共享 